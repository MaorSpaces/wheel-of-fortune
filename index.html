<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wheel of Fortune</title>
    <style>
        body { font-family: Arial, sans-serif; background: white; margin: 20px; }
        .wheel-container { display: inline-block; margin: 20px; text-align: center; }
        canvas { border: 1px solid #ccc; background: white; }
        input, button { margin: 5px; padding: 5px; }
        .history { width: 300px; height: 150px; border: 1px solid #ccc; overflow-y: scroll; margin-top: 10px; padding: 5px; }
    </style>
</head>
<body>
    <h1>Wheel of Fortune</h1>
    <div>
        <label>Number of Decisions: </label>
        <input type="number" id="numDecisions" value="8" min="2" max="20">
        <button onclick="updateWheels()">Update Wheels</button>
    </div>

    <div class="wheel-container">
        <h2>Chores</h2>
        <canvas id="choresCanvas" width="400" height="400"></canvas>
        <br><button id="spinChores" onclick="spinWheel('chores')">Spin</button>
        <div id="choresHistory" class="history"></div>
    </div>

    <div class="wheel-container">
        <h2>Activities</h2>
        <canvas id="activitiesCanvas" width="400" height="400"></canvas>
        <br><button id="spinActivities" onclick="spinWheel('activities')">Spin</button>
        <div id="activitiesHistory" class="history"></div>
    </div>

    <script>
        let numDecisions = 8;
        let decisions = Array.from({length: 8}, (_, i) => `Option ${i+1}`);
        let isSpinning = false;
        const colors = ["#FF6B6B", "#4ECDC4", "#45B7D1", "#96CEB4", "#FFEEAD", "#D4A5A5", "#9B59B6", "#3498DB"];

        // Draw wheel function (shared)
        function drawWheel(canvasId, angle) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, 400, 400);
            const centerX = 200, centerY = 200, radius = 180;
            const anglePerSegment = (2 * Math.PI) / numDecisions;

            // Draw segments
            for (let i = 0; i < numDecisions; i++) {
                const startAngle = angle + i * anglePerSegment;
                const endAngle = startAngle + anglePerSegment;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.fillStyle = colors[i % colors.length];
                ctx.fill();
                ctx.strokeStyle = 'white';
                ctx.lineWidth = 2;
                ctx.stroke();

                // Draw text
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(startAngle + anglePerSegment / 2);
                ctx.fillStyle = 'black';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(decisions[i], radius * 0.7, 5);
                ctx.restore();
            }

            // Draw fixed pointer (red triangle above)
            ctx.beginPath();
            ctx.moveTo(200, 10); ctx.lineTo(190, 30); ctx.lineTo(210, 30);
            ctx.closePath();
            ctx.fillStyle = 'red';
            ctx.fill();
        }

        // Initial draw
        drawWheel('choresCanvas', 0);
        drawWheel('activitiesCanvas', 0);

        function updateWheels() {
            const newNum = parseInt(document.getElementById('numDecisions').value);
            if (newNum >= 2 && newNum <= 20) {
                numDecisions = newNum;
                decisions = Array.from({length: numDecisions}, (_, i) => `Option ${i+1}`);
                drawWheel('choresCanvas', 0);
                drawWheel('activitiesCanvas', 0);
            } else {
                alert('Number must be 2-20');
            }
        }

        function spinWheel(wheel) {
            if (isSpinning) return;
            isSpinning = true;
            document.getElementById('spinChores').disabled = true;
            document.getElementById('spinActivities').disabled = true;

            const canvasId = wheel === 'chores' ? 'choresCanvas' : 'activitiesCanvas';
            const historyId = wheel === 'chores' ? 'choresHistory' : 'activitiesHistory';
            const buttonId = wheel === 'chores' ? 'spinChores' : 'spinActivities';

            let currentAngle = 0;
            const spins = Math.random() * 3 + 4; // 4-7 rotations
            const totalAngle = spins * 2 * Math.PI + Math.random() * 2 * Math.PI;
            const steps = 100;
            const stepAngle = totalAngle / steps;
            let step = 0;

            function animate() {
                if (step < steps) {
                    currentAngle += stepAngle;
                    drawWheel(canvasId, currentAngle);
                    step++;

                    const t = step / steps;
                    let easing = -(Math.cos(Math.PI * t) - 1) / 2;
                    if (t > 0.9) easing += 0.05 * Math.sin(10 * Math.PI * (t - 0.9));
                    const delay = Math.max(5, Math.floor(10 * (1 - easing)));
                    setTimeout(animate, delay);
                } else {
                    isSpinning = false;
                    document.getElementById('spinChores').disabled = false;
                    document.getElementById('spinActivities').disabled = false;

                    // Select decision
                    const normalizedAngle = (currentAngle % (2 * Math.PI));
                    const selectedIndex = Math.floor((normalizedAngle / (2 * Math.PI)) * numDecisions);
                    const selected = decisions[selectedIndex];
                    const now = new Date().toISOString().slice(0, 19).replace('T', ' ');
                    document.getElementById(historyId).innerHTML += `<div>${now}: ${selected}</div>`;
                }
            }
            animate();
        }
    </script>
</body>
</html>